An illustrated guide to medical statistics using SPSS

Ch.1

·독립변수(Independent variable)      종속변수(Dependent variable)
-설명변수(Explanatory variable)     -반응변수(Response variable)
-예측변수(Predictor variable)       -결과변수(Outcome variable)
-위험인자(Risk factor)              -표적변수(Target variable)
-공변량(Covariate) : 연속형 자료
-요인(Factor) : 범주형 자료

·자료의 분류
자료 : 범주형자료(categorical data) / 연속형자료(numerical data)
-범주형자료 : 범주를 서로 구분하는 자료, 질적자료(qualitative data)라고도 한다
-연속형자료 : 연속적인 수로 수량화가 가능한 자료, 양적자료(quantitative data)라고도 한다

범주형자료 : 명목척도(nominal scale) / 순위척도(ordinal scale)
-명목척도 : 서열에 관계없이 이름으로만 의미를 가짐(서열성X) ex.성별,혈액형,치료효과의 유무
-순위척도 : 자료들 간 순서가 존재(서열성O) ex.종양 1기~4기, 질병의 중증도 1~3단계

연속형자료 : 간격척도(interval scale) / 비척도(ratio scale)
-간격척도 : 물의 어는점은 인위적으로 설정된 영점 -> 절대영점이 없음
-비척도 : 키,체중,혈중 알코올 농도 등은 본래부터 절대적인 0점이 존재 -> 절대영점이 있음

* 순위척도 vs 연속형자료
학생들의 학년은 수로 되어있지만 평균낼 순 없음 (1학년 4명, 2학년 1명, 3학년 2명 =/= (1*4+2*1+3*2)/3 = 평균4학년) -> 순위척도
학생들의 성적은 수로 되어있고, 평균내서 이용 가능 -> 연속형자료

* 자료(변수)의 성격은 변할 수 있음 -> 나이는 연속형자료(비척도)이지만 10대,20대,30대...로 나누면 순위척도가 되고, 미성년,성년으로 나누면 명목척도가 된다

* 보건의학 연구에서는 해석의 편리함 때문에 범주형 형태의 자료가 연속형 형태보다 더 선호되는 경향이 있음

* 보건의학 연구는 '다른 상황을 생각하게 하는 현저한 근거가 없는 한 현상적인 모든 차이는 0(무)이다' 라는 과학철학적 명제에서 시작함

·귀무가설(null hypothesis, H0) : 연구자가 증명하고자 하는 실험가설과 반대되는 입장, 증명되기 전까지는 효과도, 차이도 없다
·대립가설(alternative hypothesis, H1) : 연구자가 실험을 통해 규명하고자 하는 가설

1.귀무가설 가정 : '치료법은 효과가 없다'라는 귀무가설 전제하에 연구시작
2.임상시험 수행 : 실험결과 통계적으로 유의한 결과를 얻음 (p<0.05)
3.결과해석 불가 : 귀무가설을 전제로 이런 결과가 도출될 가능성은 전체 5% 미만
4.귀무가설 기각 : 그렇다면 처음에 전제로 가정했던 귀무가설은 틀렸음
5.대립가설 채택 : 실제로 효과가 있기 때문(귀무가설)에 이 결과가 관찰된 것이라고 간주

·우위성 검정의 예
ex. 200명의 환자를 무작위로 100명씩 두 군으로 배정하여 각각 치료법 A와 B를 실시한 후 두 치료법의 효과에 차이가 있는지 없는지 확인
-귀무가설 H0 : 두 치료법의 효과에 차이가 없다
-대립가설 H1 : 두 치료법의 효과에 차이가 있다
-> 결과 : 치료군 A에서는 90명의 환자, 치료군 B에서는 80명의 환자에서 반응
-> 두 군의 비율을 비교하는 통계 분석법인 카이제곱 검정으로 검정하면 p=0.048
   이는 귀무가설 전제하에서 이 현상이 관찰될 학률이 4.8%에 불과하다는 뜻으로 귀무가설로는 현상을 설명하기 어렵기 때문에 유의수준 5%에서 귀무가설을 기각하고 대립가설을 채택
   따라서, 치료법 A가 치료법 B보다 더 효과적이다

·동등성 검정의 예
ex. 기존의 치료법 B보다 비용이 줄어든 치료법 A에 대해서 두 치료법의 효과가 동등함을 증명하고자 함
-두 군에 50명의 환자를 무작위 배정, 각각 치료법 A와 치료법 B를 적용
-> 결과 : 치료법 A를 받은 50명 중 45명, 치료법 B를 받은 50명 중 40명에서 반응
-> 교차분석 시행 : p value=0.161
   이는 '두 치료법의 효과에 차이는 없다'는 귀무가설을 기각하지 못하므로 귀무가설을 채택하여 결론지을 수 있나?
   만약 그렇다면 연구대상(n)만 줄여주면 두 군의 차이를 입증하기 어려워지므로 항상 동등하나는 결론을 얻게되는 문제가 있음
   따라서, 귀무가설을 기각하지 못했다고 귀무가설이 옳음이 입증되는 것은 아니다

* 동등성을 검정하고자 할 때는 우리가 증명하고자 하는 명제인 '두 치료법 효과에 차이가 없다'가 대립가설이 되고, 그 반대로 '두 치료법 효과에 차이가 있다'가 귀무가설이 된다
* 적절한 통계 분석법에 따라 이 귀무가설이 기각되어야 '효과에 차이가 없다'는 대립가설이 채택되는 것이다

·5% 유의수준과 다중비교

                                               실제 진리
                                   실제로 효과 없음 | 실제로 효과 있음
         검정결과                      귀무가설 참  |   귀무가설 거짓
실험결과 효과 없음(귀무가설 채택)  |        참       |  오류(제2종오류β)
실험결과 효과 있음(귀무가설 기각)  | 오류(제1종오류α) |   참(검정력 1-β)

·제1종오류(α)
-실제로 효과가 없는데 실험결과 효과가 있다고 나오는 오류
-가장 문제가 되는 오류로 학계에서는 이를 5% 미만으로 통제함
-'P<0.05'란 실제로는 효과가 없는데 검정결과 효과가 있다고 잘못 결론 낼 확률이 5% 미만이라는 뜻

·5% 유의수준
-통계분석에서 1종오류를 범할 가능성을 5% 미만으로 제한한다는 뜻

·검정력(power of test) 1-β
-실제 효과가 있는 것을 통계적으로 효과가 있다고 보여줄 수 있는 힘
-연구자들은 제1종오류를 5%로 유지하면서 검정력을 최대화하는 통계기법을 사용

·다중비교의 문제
ex. A군 vs B군 : p<0.05 -> 3개의 치료법의 효과를 동시에 비교할 때 A군과 B군의 크기가 유의하게 차이가 있다고 할 수 있는가? X
    B군 vs C군 : p>0.05
    A군 vs C군 : p>0.05

* 3개의 치료법의 효과를 동시에 비교하고자 할 때는 X
-> 한번의 실험에서 얻은 결과에서 3가지 가설을 세우고 각각 5% 유의수준으로 동시에 검정을 시도하면 5% 유의수준이 3번 사용되므로 각각이 독립인 경우 1-(1-0.05^3) = 0.143(14.3%)의 유의수준을 적용한 것과 같음
* 1-(모두 accept하는 경우) = 적어도 1번은 reject하는 경우
* 만약 하나의 실험결과로 20개의 가설을 세워 각각 5% 유의수준으로 검정
-> 5% 유의수준이란 효과가 없음에도 효과가 있다고 나올 제 1종 오류를 5% 이내에서 조절하겠다는 뜻이므로 20개 모두 효과가 없음에도 적어도 하나는 효과가 있다고 잘못 결론지어질 확률이 5%보다 높아짐
-> 다중비교의 문제(multiple comparison problem)
-> 가설을 검정할 때는 전체 유의수준이 지정된 5%를 넘지 않아야한다

·여러가설을 동시에 비교하는 방법
-세군(A,B,C)의 치료효과 비교
1. 세 군의 크기가 모두 같은지 검정
2. 어떤 군 사이에 차이가 있는지 밝힌다 -> 사후분석(post hoc) : 유의수준 보정
   A-B / B-C / A-C -> 총 3번의 검정 수행 : 전체 유의수준이 5%를 유지 (Bonferroni, Tukey, Duncan, Scheffe 등...)

·Bonferroni's method
-여러 사후분석법 중 가장 보수적인 방법 중 하나
-어느 통계 분석법에나 적용 가능, 직관적인 이해가 가능
-유의수준 5%를 검정의 총 개수로 나누어 개별 검정에 적용
ex. A군-B군-C군 : 5/3=1.7%,  A군-대조군/B군-대조군 : 5/2=2.5% -> 군의 개수X, '검정의 수'로 나눔

·자유도
: 실질적으로 독립인 값들의 개수
ex. 평균이 μ인 10개의 자료들 중 9개의 값은 아무 값이나 가능하지만 마지막 남은 1개의 값은 평균이 μ로 정해져 있으므로 다른 값들에 의해 정의됨
    -> 자유도=9 (평균이 정해져있다면 자유도는 자료의 개수-1)

        당뇨 | 정상 |  계
고혈압 |  a  |   b  |  20
정상   |  c  |   d  |  80           -> a,b,c,d 중 1개만 알면 나머지 값이 자동으로 정의됨 : 자유도=1
계     | 25  |  75  |  100

        당뇨 | 치매 | 정상 |  계
고혈압 |  a  |   b  |  c  |  20
정상   |  d  |   e  |  f  |  80     -> a,b,c,d,e,f 중 2개만 알면 나머지 값이 자동으로 정의됨 : 자유도=2
계     | 25  |  25  |  50 |  100

ex. nxm교차표에서 주변합이 모두 정해져 있을 때 자유도는 (n-1)*(m-1) 이다

·분포와 검정 통계량
-어떤 집단에서 개개의 관측값들을 측정하거나 혹은 동일한 현상에 대해 반복적으로 관측된 결과들을 집합적으로 살펴보면 특징적인 분포를 이루는 경향이 있음
-집합적 양상에 근거하여 연구괄가가 관측될 수 있는 확률을 추정할 수 있음
-확률 분포(probability distribution) : 집합적 양상

·정규분포(normal distribution)
-평균(μ)과 표준편차(σ)에 의해 결정 -> 정규분포를 따르는 자료는 평균과 표준편차만 같다면 동일한 정규분포
-수많은 생물학적 현상들의 측정결과는 표본의 크기ㅐ가 충분히 크다면 정규분포를 유사하게 따르는 경우가 많다

·표준정규분포(standard normal distribution) = Z분포
-정규분포에서 관측치(X)를 Z=X-μ/σ 로 치환 -> 평균0, 표준편차1인 정규분포
-Z검정 : 어떤 집단이 정규분포를 따른다고 가정하고 평균을 비교하는 것

·T-분포(T-distribution)
-표본 수가 정규분포를 이룰 만큼 충분히 크지 않을 때는 T-분포를 더 근사적으로 따른다고 알려져 있음
-좌우대칭 종모양으로 정규분포보다 꼬리가 길고 더 넓게 분포
-자유도에 따라 조금씩 달라짐 -> 자유도가 증가함에 따라 표준정규분포에 근접
-대부분 모집단의 값(모수)을 모르고 표본집단의 값(통계량)을 안다
-> 모집단의 표준편차(σ)대신 표본의 표준편차(S)를 사용, 이 때 표본평균이 T-분포를 이룬다는 가정하에 분석
-T검정(T-Test) : T-분포를 이용하여 독립인 두 군의 평균을 비교하는 방법

·카이제곱(χ^2)분포(chi-squared distribution)
-χ^2분포는 표준정규분포를 따르는 독립적인 확률분포(χ1-μ/σ)를 제곱(χ1^2-μ^2/σ^2)하여 합해서 얻어지는 분포
-자유도 1인 카이제곱분포를 따르는 서로 독립인 확률변수 χ1,χ2,χ3...χN을 합하면 자유도 N인 카이제곱분포를 따르는 성질이 있음
-자유도에 따라 달라짐 -> 자유도가 커짐에 따라 오른쪽으로 길게 늘어진 모양이 점점 좌우대칭의 모양이 된다
-카이제곱검정 : 카이제곱분포를 이용하여 두 집단 간의 비율을 비교하는데 사용하는 통계분석법

·F분석(F distribution)
-비율에 의해 정의되는 분포, 왼쪽으로 치우친 형태
-2개의 모집단 각각의 분산 추정치의 비(변동의 치우친 비)로 정의
-> 분자와 분모 각각 자유도에 따라 형태가 결정
-분산분석(analysis of varience, ANOVA)에 흔히 사용

·분포와 검정통계량
-통계적 가설검정에는 특정한 확률분포가 이용됨
ex. 독립표본 T검정 - T분포 / 분산분석 - F분포 / 카이제곱검정 - 카이제곱분포
-검정통계량(test statistic) : 가설검정 시 관찰된 표본으로부터 계산
-귀무가설이 옳다는 가정하에 가정된 분포에서 관찰된 표본(검정통계량)이 발견될 수 있는 확률(probability value, P value)은 곡선의 아래면적
-> 분포와 검정통계량을 이용하여 유의확률(P value)을 구하는 방식

ex. 당뇨와 비만유무를 조사한 2x2분할표에서 두 질병의 연관성
-> 2x2분할표에서 χ^2 검정통계량은 자유도 1인 χ^2분포를 따른다고 알려져있음
-> 검정통계량 χ^2 = ∑(관측빈도-기대빈도)^2/기대빈도 = 8.33
-> 자유도 1인 χ^2분포에서 χ^2=8.33인 현상이 관찰될 확률 P=0.004
-> 따라서, 당뇨와 비만 사이에 연관성이 없다는 귀무가설하에서 이 현상이 관찰될 확률 = 0.4%
-> 이는 유의수준 5%보다 작음 -> 귀무가설 기각, 대립가설 채택

·중심극한정리(Central limit Theorem, CLT)
: 모집단으로부터 무작위로 표본을 추출할 때 표본의 크기가 충분히 크다면 표본변수들의 그 합 또는 평균의 히스토그램은 정규분포곡선에 수렴

* 대칭적인 자료
-주머니에 1번,2번,3번 공이 1개씩 들어있음 -> 복원추출 -> 복원추출 합의 히스토그램은 정규분포곡선에 수렴

* 치우친 자료
-주머니에 0번 공 9개, 1번 공 1개가 들어있음 -> 복원추출 -> 복원추출 합의 히스토그램은 정규분포곡선에 수렴

* 치우친 자료2
-주머니에 1번 공 1개, 2번 공 1개, 9번 공 1개가 들어있음 -> 복원추출 -> 복원추출 합의 히스토그램은 정규분포곡선에 수렴

-어떠한 형태의 자료도 추출 횟수가 증가하면 그 합의 히스토그램은 정규분포로 수렴
-모집단으로부터 무작위로 복원추출 시행 -> 표본의 수가 충분히 크다면 그 합 또는 평균의 히스토그램은 중심극한정리에 의해 정규분포곡선에 수렴
-두 집단의 값이 정규분포라고 가정 -> 평균 비교가 쉬움
-정규성 가정 : 모집단의 분포를 몰라도 표본 수가 충분히 크다면 중심극한정리에 의해 표본평균의 분포는 정규성을 띤다는 가정 -> 다양한 확률분포를 통계검정에 사용할 수 있음

·모수적 방법과 비모수적 방법
-전체 모집단을 대상으로 조사 및 실험은 현실적으로 불가능
-> 적절한 표본집단을 지정, 이 표본집단에서 평균, 표준편차같은 통계량을 구한 뒤 이를 통해 모평균과 모표준편차를 추정
-모수(parameter) : 모집단의 모평균, 모표준편차, 모분산 등
-통계량(statistics) : 추출된 표본의 평균, 표준편차, 분산 등

·모수적 방법
-중심극한정리(CLT)에 의해 모집단의 분포에 상관없이 무작위 추출된 표본의 평균은 표본 크기가 충분히 클 때 정규분포를 따른다
-> 표본의 크기가 충분히 크면 모집단의 정규성 유무와 관계없이 모평균에 대한 가설검정 시행 가능
* 정규성을 갖는다는 모수적 특성을 이용하는 통계적 방법 -> 모수적 방법(parametic method)

* 중심극한정리에 의해 표본평균이 정규분포를 따른다고 가정할 수 있는 최소환의 표본의 크기 = 30

* 만약 표본의 크기가 10~30이면 정규성 검정을 통해서 정규분포임을 확인한 후 모수적 방법 이용

·비모수적 방법
-정규성 검정에서 정규분포를 따르지 않는다고 증명되거나, 군당 10명 이내의 소규모 실험에서는 정규분포임을 가정할 수 없고, 따라서 모수적 방법을 사용할 수 없음
-> 순위합 검정 적용 : 자료의 크기 순으로 배열하여 순위를 정한 후 순위의 합을 통해 차이를 비교하고자
-> 이런 방법들은 모집단이 특정 분포를 따르는 것으로 가정하지 않음 -> 비모수적 방법(nonparametic mothod)

* 숫자로는 표현되지만 수량화할 수 없고, 평균을 낼 수도 없는 순위척도의 경우도 비록 연속형 자료는 아니지만, 순위의 합을 적용하는 비모수적 방법 적용 가능

비모수적 방법           연속형 자료           모수적 방법
                         30 < n   -------->
 정규성 검정X <--------  10<=n<=30 --------> 정규성 검정 O
             <--------    n < 10
             <--------   순위 척도
Mann-whitney test                           독립표본 T검정
Wilcoxon signed rank test                   대응표본 T검정
Kruskal-waillis test                        일원배치 분산분석
Spearman의 순위 상관분석                     Pearson의 상관분석

* 비모수적 방법보다 모수적 방법을 더 선호함 : 가정이 잘 충족되는 경우 모수적 방법이 비모수적 방법보다 검정력이 다소 높고, 두 군 사이에 크기의 차이가 있는 경우 차이의 정도를 함께 제시 가능

* 비모수적 방법 : 1. 일반적으로 모수적 방법에 비해 분포에 대한 가정이 완화 또는 가정이 거의 없고 표본의 크기가 작은 경우에도 안정적임
                 2. 부호 또는 상대 크기의 순위 등 직관적이고 이해하기 쉬운 정보를 사용
                 3. 표본이 정규분포를 따를 때도 검정력이 크게 떨어지지 않음, 정규분포를 따르지 않으면 비모수적 방법을 사용할 수 밖에 없음

·자료의 탐색 및 정규성 검정
모든 자료는 본격적인 통계 분석에 들어가기 앞서 어떤 분포를 띠고 있는지, 치우침이나 특이점은 없는지 파악하는 것이 필요

* 탐색적 자료 분석(exploratory data analysis) : 자료의 특징과 내재하는 구조적 관계를 알아내기 위해 시행하는 모든 방법으로, 여기서 얻은 정보를 바탕으로 통계모형을 구축하는데 도움을 줌

-자료의 분포가 실제로 정규분포에 근사하는지, 회귀 분석을 시행하기 앞서 두 변수가 실제로 선형의 관계를 보이는지 파악하는 것은 매우 중요한 과정

·대표값(representative value)
: 자료를 대표할 수 있는 하나의 값 (평균, 중앙값)

-평균(mean) : 모든 관측값들을 합하고 이를 관측수로 나누어서 구함
-중앙값(median) : 관측값을 크기 순으로 배열하였을 때 한가운데 있는 수, 관측수가 짝수일 경우 한가운데의 두 수의 평균

* 자료의 개수가 많지 않은 경우 평균은 크기가 특별히 크거나 작은 한 값에 크게 영향을 받는다는 단점
* 중앙값은 이러한 특이점(outlier)의 영향이 제한적이어서 탐색적 자료분석에서 더 선호되는

·산포도(degree of scattering)
: 자료의 흩어진 정도 (분산, 표준편차, 범위, 사분위수 범위 등)

-분산(variance) : 개별 관측치와 평균의 차이의 제곱의 평균
-표준편차(standard deviation) : 분산의 제곱근
-범위(range) : 자료의 가장 큰 값과 작은 값의 차이
               특이점(outlier)이 포함된 경우에는 자료의 흩어진 정도를 보여주는 척도로 적절치 않음

·사분위수(quartiles)
: 자료를 4등분한 값
ex. 400개의 값을 크기순으로 배열 -> 100번째 값 = 1사분위수 / 200번째 값 = 2사분위수(=중앙값) / 300번째 값 = 3사분위수

-사분위수 범위(interquartile range) : 3분위수 - 1분위수 -> 분포의 퍼진 정도 = 전체 자료의 중간에 위치한 50%의 값들이 지니는 범위

-사분위수의 장점
* 사분위수는 멀리 떨어져 있는 특이점에 의한 영향을 받지 않음
* 표본수에 따라서도 거의 영향을 받지 않음

* 다섯수치요약(five number summary) : 최소값, 최댓값, 중앙값, 1사분위수, 3사분위수
ex. 10, 12, 37, 6, 15, 21, 33, 22, 12 -> 크기 순으로 정렬

6  -------------------------------------- 최소값
10                                          |
12 ----------------------- 1사분위수         |            평균=18.7
12                            |             |          표준편차=10.6
15 : 중앙값 = 2사분위수    4분위수 범위      범위            중앙값=15
21                            |             |         사분위수 범위=10
22 ----------------------- 3사분위수         |            범위=31
33                                          |         다섯수치 요약
37 -------------------------------------- 최대값     =(6,12,15,22,37)

·왜도와 첨도 : 분포의 특징을 보여줌
-왜도(skewness) : 자료의 치우친 정도
-첨도(kurtosis) : 자료가 뾰족한 정도

* 정규분포 기준
오른쪽으로 치우침 : 음의 왜도,   왼쪽으로 치우짐 : 양의 왜도
납작한 분포       : 음의 첨도,   뾰족한 분포    : 양의 첨도
-> 정규분포의 왜도와 첨도는 0

·정규성 검점
1. 일반적으로 표본수가 30을 넘는 경우 중심극한정리에 의해 모집단의 분포에 상관없이 표본평균이 정규성을 가진다고 할 수 있음
2. 하지만 표본수가 10~30인 경우 정규성 검정을 통해 정규성을 검정함
3. 표본수가 10 미만이면 정규성을 인정받기에 자료의 수가 너무 적으므로 비모수적 통계 방법을 사용

·정규성 검정의 가설 설정
-귀무가설 H0 : 자료는 정규분포를 따른다
-대립가설 H1 : 자료는 정규분포를 따르지 않는다

* 정규성 검정을 위해 흔히 사용되는 검정방법
1. Kolmogorov-Smirnov test
2. Shapiro-wilk test

* 정규성 검정에서는 정규성을 만족하는 것이 귀무가설로 설정됨
-> p-value가 0.05보다 작다면 귀무가설이 기각되어 정규성이 만족되지 않는 것
   p-value가 0.05보다 크다면 귀무가설이 채택되어 정규분포를 따른다고 가정

* 귀무가설을 기각하지 못한다는 것이 꼭 귀무가설이 옳다는 것을 의미하는 건 아님 -> '정규분포를 따르지 않는다고 말할 충분한 근거가 없다'가 더 옳은 표현
-> 따라서, 적어도 자료의 개수가 10개 이상일 때만 이 검정에 의미를 부여할 수 있음 (자료가 4~5개면 정규성 자체가 성립 X)